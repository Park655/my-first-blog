{% load custom_filters %}
<div class="responsive-table">
    <form method="GET" class="search-form" style="margin-bottom: 20px;">
        <input type="text" name="q" placeholder="성분 검색..." value="{{ query|default_if_none:'' }}" style="padding: 8px; width: 200px;">
        <div style="margin-top: 10px; margin-bottom: 10px;">
            <strong>효능 필터:</strong><br>
            {% for cat in categories %}
                <label style="margin-right: 12px;">
                    <input type="checkbox" name="categories" value="{{ cat.id }}"
                        {% if cat.id in selected_categories %}checked{% endif %}>
                    {{ cat.name }}
                </label>
            {% endfor %}
        </div>
        <button type="submit" style="padding: 8px 12px;">검색</button>
    </form>

    <table>
        <thead>
            <tr>
                <th>성분명</th>
                <th>효능</th>
                <th>부작용</th>
                <th>특이사항</th>
            </tr>
        </thead>
        <tbody>
            {% for s in supplements %}
            <tr>
                <td>{{ s.name }}</td>
                <td>{{ s.effect|to_list }}</td>
                <td>{{ s.side_effect|to_list }}</td>
                <td>{{ s.note|to_list }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="4">검색 결과가 없습니다.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
